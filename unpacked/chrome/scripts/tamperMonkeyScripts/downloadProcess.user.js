!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=124)}({124:function(e,t){!async function(){"use strict";var e=document.createElement("style");e.innerHTML=".pure-button-pdf { color: #eb6841; background: #fff; } .pdfIcon { margin-left:10px; margin-right:10px;} .lds-circle { display: inline-block; transform: translateZ(1px); } .lds-circle { display: inline-block; animation: lds-circle 2.4s cubic-bezier(0, 0.2, 0.8, 1) infinite; } @keyframes lds-circle {  0%, 100% { animation-timing-function: cubic-bezier(0.5, 0, 1, 0.5); } 0% { transform: rotateY(0deg); } 50% { transform: rotateY(1800deg); animation-timing-function: cubic-bezier(0, 0.5, 0.5, 1); } 100% { transform: rotateY(3600deg); } }",document.getElementsByTagName("head")[0].append(e);var t=document.createElement("button");t.classList.add("pure-button","pure-button-pdf","pure-button-large");var n=document.createElement("i");n.classList.add("fas","fa-file-pdf","fa-1x","pdfIcon"),t.append(n);var a=document.createElement("span");a.innerHTML="Download PDF";var r=document.createElement("span");t.append(a),t.append(r),document.getElementsByClassName("profile-user")[0].append(t),t.onclick=async function(){n.classList.add("lds-circle"),a.innerHTML="Generating...",r.innerHTML="0%";var e=document.getElementsByClassName("task-completed"),t=[],o=0,i=e.length;const s=await PDFLib.PDFDocument.create();for(var c of e){var l=c.dataset.href,d=l.replace("task-details","form");let e=new Headers({Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"});var f=parseInt(l.match(/task=([0-9]+)/)[1]);console.log(f),await fetch(d,{method:"GET",headers:e}).then((function(e){return e.json()})).then((function(e){console.log(e);var c=e.Message.html;c=(c=c.replace(/form-section/g,"form-section-off")).replace(/<ul class/g,'<ul style="display:none;" class'),console.log(c);var l=c.match(/\/workflows\/processes\/.*\/get-file\?id=[a-zA-z0-9]*/g);if(l)for(var d of(i+=l.length,l))fetch(d).then((function(e){return e.blob()})).then((async function(e){console.log(e.type);let c=new FileReader;c.readAsArrayBuffer(e),c.onload=async function(){if("application/pdf"===e.type){const e=await PDFLib.PDFDocument.load(c.result);console.log(e);const t=e.getPages().length;(await s.copyPages(e,Array.from(Array(t).keys()))).forEach(e=>{s.addPage(e)})}else if("image/jpeg"===e.type){const e=await s.embedJpg(c.result),t=e.scale(.5),n=s.addPage([t.width,t.height]);n.drawImage(e,{x:n.getWidth()/2-t.width/2,y:n.getHeight()/2-t.height/2,width:t.width,height:t.height})}o+=1,r.innerHTML=parseInt(o/(i+3)*100).toString()+"%",o===i&&html2pdf().set({html2canvas:{scale:2},pagebreak:{before:".page-break",avoid:["div","h1",".form-section-offs"]}}).from('<div style="padding:100px;">'+t.join(" ")+"</div>").output("datauristring").then((async function(e){r.innerHTML=parseInt(o/(i+2)*100).toString()+"%";const t=await PDFLib.PDFDocument.load(e);r.innerHTML=parseInt(o/(i+1.5)*100).toString()+"%";const c=s.getPages().length,l=await t.copyPages(s,Array.from(Array(c).keys()));r.innerHTML=parseInt(o/(i+1.2)*100).toString()+"%",l.forEach(e=>{t.addPage(e)}),r.innerHTML=parseInt(o/(i+1)*100).toString()+"%";var d=document.getElementsByClassName("fn")[0].innerText,f=document.getElementById("page-header").innerText;saveAs(new Blob([await t.save()]),d+" - "+f+".pdf"),r.innerHTML=parseInt(o/i*100).toString()+"%",n.classList.remove("lds-circle"),a.innerHTML="PDF Saved!",r.innerHTML=""}))}}));console.log(l);var p=e.Message.header;t[f]="<h1>"+p+"</h1>"+c,o+=1,r.innerHTML=parseInt(o/(i+3)*100).toString()+"%",o===i&&html2pdf().set({html2canvas:{scale:2},pagebreak:{before:".page-break",avoid:["div","h1",".form-section-offs"]}}).from('<div style="padding:100px;">'+t.join(" ")+"</div>").output("datauristring").then((async function(e){r.innerHTML=parseInt(o/(i+2)*100).toString()+"%";const t=await PDFLib.PDFDocument.load(e);r.innerHTML=parseInt(o/(i+1.5)*100).toString()+"%";const c=s.getPages().length,l=await t.copyPages(s,Array.from(Array(c).keys()));r.innerHTML=parseInt(o/(i+1.2)*100).toString()+"%",l.forEach(e=>{t.addPage(e)}),r.innerHTML=parseInt(o/(i+1)*100).toString()+"%";var d=document.getElementsByClassName("fn")[0].innerText,f=document.getElementById("page-header").innerText;saveAs(new Blob([await t.save()]),d+" - "+f+".pdf"),r.innerHTML=parseInt(o/i*100).toString()+"%",n.classList.remove("lds-circle"),a.innerHTML="Saved",r.innerHTML=""}))}))}}}()}});
//# sourceMappingURL=downloadProcess.user.js.map