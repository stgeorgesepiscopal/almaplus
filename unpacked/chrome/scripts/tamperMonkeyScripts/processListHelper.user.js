!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=125)}({125:function(e,t){var n=window["pdfjs-dist/build/pdf"];n.GlobalWorkerOptions.workerSrc="//greasyfork.org/scripts/388115-pdf-js-worker/code/PDFjs%20Worker.js?version=721821";const a=e=>{const t=new FileReader;return new Promise((n,a)=>{t.onerror=()=>{t.abort(),a(new DOMException("Problem parsing input file."))},t.onload=()=>{n(t.result)},t.readAsArrayBuffer(e)})};function r(e){return e=(e=e.replace(/src=/g,"data-src=")).replace(/<link/g,"nolink")}function o(e){const t=e;fetch(e.href).then((function(e){return e.text()})).then((function(e){e=r(e);for(var n,a=(new DOMParser).parseFromString(e,"text/html"),o=document.evaluate("//li[contains(@class,'task')][not(contains(@class,'task-complete'))]",a,null,XPathResult.ANY_TYPE,null);n=o.iterateNext();){var i=document.createElement("div");i.classList.add("pill"),i.innerHTML='<i class="far fa-times-circle" style="color:#eb6841;"></i>'+n.textContent.trim(),t.parentElement.parentElement.children[4].append(i)}}))}function i(e){var t=e,a=document.createElement("div");a.classList.add("pure-button","pure-button-pdf","pure-button-large","image-icon-button");var o=document.createElement("i");o.classList.add("far","fa-images","fa-1x","pdfIcon"),a.append(o);t.parentElement.parentElement.children[0].append(a),a.onclick=async function(){o.classList.add("lds-circle"),fetch(e.href).then((function(e){return e.text()})).then((function(e){e=r(e);for(var a,i=(new DOMParser).parseFromString(e,"text/html"),c=document.evaluate("//li[contains(@class,'task')]",i,null,XPathResult.ANY_TYPE,null),s=0,l=0;a=c.iterateNext();){var d=a.dataset.href.replace("task-details","form");let e=new Headers({Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"});fetch(d,{method:"GET",headers:e}).then((function(e){return e.json()})).then((function(e){var a=e.Message.html,r=(a=(a=a.replace(/form-section/g,"form-section-off")).replace(/<ul class/g,'<ul style="display:none;" class')).match(/\/workflows\/processes\/.*\/get-file\?id=[a-zA-z0-9]*/g);if(r)for(var i of(s+=r.length,o.classList.add("lds-circle"),r))fetch(i).then((function(e){return e.blob()})).then((async function(e){console.log(e.type);let a=new FileReader;a.readAsArrayBuffer(e),a.onload=async function(){var a;"application/pdf"===e.type?(a=document.createElement("canvas"),n.getDocument(i).promise.then((function(e){console.log("PDF loaded");e.getPage(1).then((function(e){console.log("Page loaded");var t=e.getViewport(.25),n=a,r=n.getContext("2d");n.height=230,n.width=160;var o={canvasContext:r,viewport:t};e.render(o).promise.then((function(){console.log("Page rendered")}))}))}),(function(e){console.error(e)})),t.append(a)):((a=document.createElement("img")).src=i,a.width=160,t.append(a));(l+=1)===s&&o.classList.remove("lds-circle")}}))}))}})).then((function(){}))}}function c(e){var t=e,n=document.createElement("div");n.classList.add("pure-button","pure-button-pdf","pure-button-large","trash-icon-button");var a=document.createElement("i");a.classList.add("fas","fa-trash","fa-1x","trashIcon"),n.append(a);t.parentElement.parentElement.children[0].append(n),n.onclick=async function(){a.classList.add("lds-circle");var n=e.href+"/delete",r=e.href.split("/").pop();window.confirm("Really delete? Can't undo!")?(await fetch(n,{method:"POST",headers:new Headers,body:JSON.stringify({id:r,confirm:"DESTROY"})}).then(e=>e.text()).then(e=>console.log(n)),a.classList.remove("lds-circle"),t.parentElement.parentElement.remove()):a.classList.remove("lds-circle")}}function s(e){for(var t,n=document.evaluate(e,document,null,XPathResult.ANY_TYPE,null),a=[];t=n.iterateNext();)a.push(t);return a}function l(){var e;for(e of document.getElementsByClassName("image-icon-button"))e.click()}function d(){var e;for(e of document.getElementsByClassName("pdf-icon-button"))e.click()}function f(e,t=!1){const n=t;var o=e,i=document.createElement("div"),c=document.createElement("i");n?(i.classList.add("pure-button","pure-button-pdf","pure-button-large","health-icon-button"),c.classList.add("fas","fa-notes-medical","fa-1x","pdfIcon")):(i.classList.add("pure-button","pure-button-pdf","pure-button-large","pdf-icon-button"),c.classList.add("fas","fa-file-pdf","fa-1x","pdfIcon")),i.append(c);var s,l="";o.parentElement.parentElement.children[0].append(i),i.onclick=async function(){c.classList.add("lds-circle");const t=await PDFLib.PDFDocument.create();var o=[];const i=await fetch(e.href);var d=await i.text();d=r(d);var f,u=(new DOMParser).parseFromString(d,"text/html");s=u.getElementsByClassName("fn")[0].innerText.trim(),n?(l="HEALTH "+u.getElementById("page-header").innerText.trim(),f="//li[contains(@class,'task')][div/h5[contains(text(),'Health' ) or contains(text(), 'Medi')]]"):(l=u.getElementById("page-header").innerText.trim(),f="//li[contains(@class,'task')]");for(var p,m=document.evaluate(f,u,null,XPathResult.ANY_TYPE,null);p=m.iterateNext();){var g=p.dataset.href,h=g.replace("task-details","form");let e=new Headers({Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"});var v=parseInt(g.match(/task=([0-9]+)/)[1]);console.log(v);var b=await fetch(h,{method:"GET",headers:e}),y=await b.json();console.log(y);var w=y.Message.html;w=(w=w.replace(/form-section/g,"form-section-off")).replace(/<ul class/g,'<ul style="display:none;" class'),console.log(w);var x=w.match(/\/workflows\/processes\/.*\/get-file\?id=[a-zA-z0-9]*/g);if(x)for(var E of x){var P=await fetch(E),k=await P.blob();console.log(k.type);const e=await a(k);if("application/pdf"===k.type){const n=await PDFLib.PDFDocument.load(e);console.log(n);const a=n.getPages().length;(await t.copyPages(n,Array.from(Array(a).keys()))).forEach(e=>{t.addPage(e)})}else if("image/jpeg"===k.type){const n=await t.embedJpg(e),a=n.scale(.5),r=t.addPage([a.width,a.height]);r.drawImage(n,{x:r.getWidth()/2-a.width/2,y:r.getHeight()/2-a.height/2,width:a.width,height:a.height})}else if("image/png"===k.type){const n=await t.embedPng(e),a=n.scale(.5),r=t.addPage([a.width,a.height]);r.drawImage(n,{x:r.getWidth()/2-a.width/2,y:r.getHeight()/2-a.height/2,width:a.width,height:a.height})}}console.log(x);var L=y.Message.header;o[v]="<h1>"+L+"</h1>"+w}html2pdf().set({html2canvas:{scale:2},pagebreak:{before:".page-break",avoid:["div","h1",".form-section-offs"]}}).from('<div style="padding:100px;">'+o.join(" ")+"</div>").output("datauristring").then((async function(e){const n=await PDFLib.PDFDocument.load(e),a=t.getPages().length;(await n.copyPages(t,Array.from(Array(a).keys()))).forEach(e=>{n.addPage(e)}),saveAs(new Blob([await n.save()]),s+" - "+l+".pdf"),c.classList.remove("lds-circle")}))}}!async function(){"use strict";var e=document.createElement("style");e.innerHTML="\n.pill {\nbackground-color: #fff;\npadding: .5em;\nborder-radius: 5px;\ndisplay: inline-block;\ncursor: default;\nmargin-top: 1em;\nfont-size: 8pt;\n}\n.pure-button-pdf { color: #eb6841; background: #fff; padding: 0.1em;}\n.pdfIcon { margin-left:2px; margin-right:2px;}\n.lds-circle { display: inline-block; transform: translateZ(1px); }\n.lds-circle { display: inline-block; animation: lds-circle 2.4s cubic-bezier(0, 0.2, 0.8, 1) infinite; }\n@keyframes lds-circle {  0%, 100% { animation-timing-function: cubic-bezier(0.5, 0, 1, 0.5); } 0% { transform: rotateY(0deg); } 50% { transform: rotateY(1800deg); animation-timing-function: cubic-bezier(0, 0.5, 0.5, 1); } 100% { transform: rotateY(3600deg); } }\n    ",document.getElementsByTagName("head")[0].append(e);var t=document.createElement("button");t.onclick=l,t.innerHTML='<i class="far fa-images"></i> Show Thumbnails for All Uploads',t.classList.add("pure-button"),document.getElementById("page-header").append(t);var n=document.createElement("button");n.onclick=d,n.innerHTML='<i class="far fa-file-pdf"></i> Download all Completed as PDFs',n.classList.add("pure-button"),document.getElementById("page-header").append(n),function(){for(let e of s("//tr[td[text()='Active (in progress)']]/td[2]/a"))o(e),c(e)}(),function(){for(let e of s("//tr[td[text()='Active (not started)']]/td[2]/a"))c(e)}(),function(){for(let e of s("//tr[td[text()='Active (complete)' or text()='Complete']]/td[2]/a"))f(e),f(e,!0),i(e)}(),function(){for(let e of s("//tr[td[text()='Withdraw']]/td[2]/a"))c(e)}()}()}});
//# sourceMappingURL=processListHelper.user.js.map